---
phase: 01-oxc-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - optimizer/Cargo.toml
  - optimizer/src/transform.rs
autonomous: true

must_haves:
  truths:
    - "All OXC crates are at version 0.111.0 in Cargo.toml"
    - "cargo build compiles without errors"
    - "cargo check produces no new errors (warnings acceptable)"
  artifacts:
    - path: "optimizer/Cargo.toml"
      provides: "OXC dependency versions"
      contains: "0.111.0"
    - path: "optimizer/src/transform.rs"
      provides: "Core transformation logic"
      min_lines: 1100
  key_links:
    - from: "optimizer/Cargo.toml"
      to: "oxc_* crates"
      via: "cargo dependency resolution"
      pattern: 'oxc_\w+ = "0\.111\.0"'
---

<objective>
Update all OXC crates from 0.94.0 to 0.111.0 and fix any compilation errors.

Purpose: Modernize the OXC dependency stack to access latest APIs and avoid technical debt from outdated patterns. This is the foundation for all subsequent phases.

Output: Compiling codebase with OXC 0.111.0 dependencies.
</objective>

<execution_context>
@/Users/jackshelton/.claude/get-shit-done/workflows/execute-plan.md
@/Users/jackshelton/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-oxc-foundation/01-RESEARCH.md

# Key source files that may need updates
@optimizer/Cargo.toml
@optimizer/src/transform.rs
@optimizer/src/import_clean_up.rs
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update OXC crate versions in Cargo.toml</name>
  <files>optimizer/Cargo.toml</files>
  <action>
Update all OXC crate versions from 0.94.0 to 0.111.0 in optimizer/Cargo.toml.

Specific changes:
- oxc_parser: "0.94.0" -> "0.111.0"
- oxc_ast: "0.94.0" -> "0.111.0"
- oxc_codegen: "0.94.0" -> "0.111.0"
- oxc_allocator: "0.94.0" -> "0.111.0"
- oxc_semantic: "0.94.0" -> "0.111.0"
- oxc_span: "0.94.0" -> "0.111.0"
- oxc_traverse: "0.94.0" -> "0.111.0"
- oxc_minifier: "0.94.0" -> "0.111.0"
- oxc_ast_visit: "0.94.0" -> "0.111.0"
- oxc_syntax: "0.94.0" -> "0.111.0"
- oxc_transformer: "0.94.0" -> "0.111.0"

Keep oxc_index at 4.1.0 (no change needed).
Keep oxc-browserslist at 2.1.2 initially - try removing if Cargo resolves correctly.
  </action>
  <verify>
Run `cargo check` and capture any compilation errors. Expected: Either compiles cleanly or produces specific API errors to fix in Task 2.
  </verify>
  <done>
Cargo.toml contains all OXC crates at version 0.111.0.
  </done>
</task>

<task type="auto">
  <name>Task 2: Fix compilation errors from API changes</name>
  <files>optimizer/src/transform.rs, optimizer/src/import_clean_up.rs</files>
  <action>
Fix any compilation errors that arise from the version upgrade. Based on research, expected issues are minimal:

**Likely issues (per RESEARCH.md):**

1. **CommentKind::Block rename** - If compilation fails on CommentKind:
   - CommentKind::Block was renamed to CommentKind::SinglelineBlock
   - Research shows CommentKind is imported at transform.rs:15 but likely unused
   - Fix: Either update the enum variant name OR remove the unused import

2. **Double scoping() call at transform.rs:1090** - If compilation fails here:
   - Pattern is `ctx.scoping.scoping().get_reference()`
   - May need to become `ctx.scoping().get_reference()` (single call)
   - Verify the field/method structure in new API

3. **oxc-browserslist version mismatch** - If Cargo dependency resolution fails:
   - Try removing the explicit oxc-browserslist dependency
   - If conflicts persist, find compatible version from oxc_transformer's deps

**Unlikely but possible:**
- New exhaustive match requirements for Ident types
- Method signature changes in TraverseCtx

For each error encountered:
1. Read the exact error message
2. Check RESEARCH.md for known solution
3. Apply minimal fix
4. Re-run cargo check
  </action>
  <verify>
Run `cargo check` - must complete with exit code 0 (warnings acceptable).
  </verify>
  <done>
Codebase compiles without errors on OXC 0.111.0.
  </done>
</task>

<task type="auto">
  <name>Task 3: Verify cargo build succeeds</name>
  <files>None (verification only)</files>
  <action>
Run full cargo build to ensure all code compiles:

1. Run `cargo build` (not just check) to verify actual compilation
2. Note any new warnings that weren't present before
3. Document build time for baseline

Do NOT fix warnings at this stage - they existed before (14 warnings baseline).
Only fix actual errors.
  </action>
  <verify>
`cargo build` exits with code 0.
  </verify>
  <done>
Full build succeeds with OXC 0.111.0 dependencies.
  </done>
</task>

</tasks>

<verification>
1. `grep -E 'oxc_\w+ = "0\.111\.0"' optimizer/Cargo.toml` shows 11 OXC crates at 0.111.0
2. `cargo check` exits 0
3. `cargo build` exits 0
</verification>

<success_criteria>
- All OXC crates updated to 0.111.0 in Cargo.toml
- Codebase compiles without errors (warnings acceptable)
- Build completes successfully
</success_criteria>

<output>
After completion, create `.planning/phases/01-oxc-foundation/01-01-SUMMARY.md`
</output>
