---
phase: 12-code-reduction
plan: 02
type: execute
wave: 2
depends_on: ["12-01"]
files_modified:
  - optimizer/src/transform/generator.rs
  - optimizer/src/transform/options.rs
  - optimizer/src/transform/state.rs
  - optimizer/src/transform/mod.rs
  - optimizer/src/transform/qrl.rs
  - optimizer/src/transform/scope.rs
autonomous: true

must_haves:
  truths:
    - "No inline comments (//) remain in core transform modules"
    - "No SWC parity comments remain"
    - "Public API doc comments preserved"
    - "All 239 tests still pass"
  artifacts:
    - path: "optimizer/src/transform/generator.rs"
      provides: "Core transformer without inline comments"
    - path: "optimizer/src/transform/options.rs"
      provides: "Options module without inline comments"
    - path: "optimizer/src/transform/qrl.rs"
      provides: "QRL module without inline comments"
    - path: "optimizer/src/transform/scope.rs"
      provides: "Scope module without inline comments"
  key_links: []
---

<objective>
Remove all inline comments from core transform modules (generator, options, state, mod, qrl, scope).

Purpose: Make code self-documenting by removing explanatory comments (~300 lines reduced).
Output: Clean code that speaks for itself through naming and structure.
</objective>

<execution_context>
@/Users/jackshelton/.claude/get-shit-done/workflows/execute-plan.md
@/Users/jackshelton/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/12-code-reduction/12-RESEARCH.md
@.planning/phases/12-code-reduction/12-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove comments from generator.rs, options.rs, state.rs, mod.rs</name>
  <files>
    optimizer/src/transform/generator.rs
    optimizer/src/transform/options.rs
    optimizer/src/transform/state.rs
    optimizer/src/transform/mod.rs
  </files>
  <action>
Remove all inline comments from these files:

1. generator.rs (~150 comment lines):
   - Remove module doc comment block at top (`//! Core AST transformation...`)
   - Remove all `//` inline comments
   - Remove all `// SWC...` parity comments
   - Remove all `// (SWC fold_...)` reference comments
   - KEEP: `///` doc comments on `pub` items (TransformGenerator, public methods)
   - KEEP: `#[derive(...)]` and other attributes

2. options.rs (~25 comment lines):
   - Remove all `//` inline comments
   - KEEP: `///` doc comments on `pub struct TransformOptions`, `pub fn transform()`

3. state.rs (~20 comment lines):
   - Remove all `//` inline comments
   - KEEP: `///` doc comments on `pub` structs if any

4. mod.rs (~10 comment lines):
   - Remove module doc comment if redundant
   - Remove inline comments
   - KEEP: any essential re-export documentation

Comment types to remove:
- `// Push marker function name...`
- `// Used to replace the current expression...`
- `// Key: local name of...`
- `// Maps source path to...`
- `// (SWC fold_call_expr)`
- `// mirrors enter_call_expression`
- `// per SWC reference`

Do NOT remove:
- `///` doc comments on public API items
- `#[cfg(test)]` or `#[allow(...)]` attributes
- License headers if present
  </action>
  <verify>
Count inline comments: `grep -c "^[[:space:]]*//[^/!]" optimizer/src/transform/generator.rs`
Should be significantly reduced (target: < 10 remaining).
Run: `cargo check --package qwik-optimizer` - compiles without errors.
  </verify>
  <done>Core modules (generator, options, state, mod) have inline comments removed.</done>
</task>

<task type="auto">
  <name>Task 2: Remove comments from qrl.rs and scope.rs</name>
  <files>
    optimizer/src/transform/qrl.rs
    optimizer/src/transform/scope.rs
  </files>
  <action>
Remove all inline comments from these domain modules:

1. qrl.rs (~40 comment lines):
   - Remove function doc comments on internal helpers
   - Remove inline `//` comments explaining logic
   - Remove any SWC parity comments
   - KEEP: `///` doc comments on `pub` functions that are part of module API

2. scope.rs (~45 comment lines):
   - Remove section header comments (`// === Scope tracking ===`)
   - Remove inline `//` comments
   - Remove function doc comments on internal helpers
   - KEEP: `///` doc comments on `pub` functions

Comments to remove examples:
- `// Filter imported identifiers...`
- `// Used by compute_scoped_idents...`
- `// Each scope level contains...`
- `// === Variable tracking ===`

After removal, verify code is still readable through:
- Clear function names
- Clear variable names
- Logical code structure
  </action>
  <verify>
Count comments: `grep -c "^[[:space:]]*//[^/!]" optimizer/src/transform/qrl.rs optimizer/src/transform/scope.rs`
Should show minimal remaining comments.
Run: `cargo test --package qwik-optimizer` - all 239 tests pass.
  </verify>
  <done>Domain modules (qrl, scope) have inline comments removed, tests pass.</done>
</task>

</tasks>

<verification>
1. `grep -r "// SWC\|// (SWC\|// per SWC" optimizer/src/transform/` returns empty
2. Comment lines significantly reduced in all touched files
3. `cargo check --package qwik-optimizer` compiles cleanly
4. `cargo test --package qwik-optimizer` passes all 239 tests
5. Public API doc comments preserved
</verification>

<success_criteria>
- All inline comments removed from generator.rs, options.rs, state.rs, mod.rs, qrl.rs, scope.rs
- All SWC parity comments removed
- Public API doc comments preserved
- All 239 tests pass
- ~300 lines reduced
</success_criteria>

<output>
After completion, create `.planning/phases/12-code-reduction/12-02-SUMMARY.md`
</output>
