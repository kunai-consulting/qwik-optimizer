---
source: optimizer/src/spec_parity_tests.rs
expression: output
---
==INPUT==

import { $, component$, useSignal, Signal } from '@qwik.dev/core';
export const App = component$(() => {
	const data = useSignal<Signal<any>[]>([]);
	const selectedItem = useSignal<any | null>(null);
	const clickedIndex = useSignal<number | null>(null);
    return (
        <div>
          {data.value.map((row, idx) => (
              <tr
                key={untrack(() => row.value.id)}
                class={row.value.selected.value ? "danger" : ""}
              >
                <td class="col-md-1">{row.value.id}</td>
                <td class="col-md-4">
                  <a
                    onClick$={() => {
                      if (selectedItem.value) {
                        selectedItem.value.selected.value = false;
                      }
                      selectedItem.value = row.value;
                      row.value.selected.value = true;
					  clickedIndex.value = idx;
                    }}
                  >
                    {row.value.label.value}
                  </a>
                </td>
                <td class="col-md-1">
                  <a
                    onClick$={() => {
                      const dataValue = untrack(() => data.value);
                      data.value = dataValue.toSpliced(
                        dataValue.findIndex((d) => d.value.id === row.value.id),
                        1,
                      );
                    }}
                  >
                    <span aria-hidden="true">x</span>
                  </a>
                </td>
                <td class="col-md-6" />
              </tr>
          ))}
        </div>
      );
    });

============================= ./should_extract_single_qrl_with_index.tsx_App_component_div_map_tr_td_a_onClick_1_TPSouZvQJzc.js (ENTRY POINT)==

import { useLexicalScope } from "@qwik.dev/core";
export const App_component_div_map_tr_td_a_onClick_1_TPSouZvQJzc = (_, _1, row) => {
	const [data] = useLexicalScope();
	const dataValue = untrack(() => data.value);
	data.value = dataValue.toSpliced(dataValue.findIndex((d) => d.value.id === row.value.id), 1);
};


None
/*
{
  "origin": "should_extract_single_qrl_with_index.tsx",
  "name": "App_component_div_map_tr_td_a_onClick_1_TPSouZvQJzc",
  "entry": null,
  "displayName": "should_extract_single_qrl_with_index.tsx_App_component_div_map_tr_td_a_onClick_1",
  "hash": "TPSouZvQJzc",
  "canonicalFilename": "should_extract_single_qrl_with_index.tsx_App_component_div_map_tr_td_a_onClick_1_TPSouZvQJzc",
  "path": ".",
  "extension": "js",
  "parent": null,
  "ctxKind": "function",
  "ctxName": "App_component_div_map_tr_td_a_onClick_1_TPSouZvQJzc",
  "captures": false,
  "loc": [
    0,
    0
  ]
}
*/
============================= ./should_extract_single_qrl_with_index.tsx_App_component_BG7ATvMKir4.js (ENTRY POINT)==

import { _fnSignal, _jsxSorted, qrl, useSignal } from "@qwik.dev/core";
export const App_component_BG7ATvMKir4 = () => {
	const data = useSignal([]);
	const selectedItem = useSignal(null);
	const clickedIndex = useSignal(null);
	return /*#__PURE__*/ _jsxSorted("div", null, null, data.value.map((row, idx) => /*#__PURE__*/ _jsxSorted("tr", { class: _fnSignal(_hf0, [row, idx], _hf0_str) }, null, [
		/*#__PURE__*/ _jsxSorted("td", null, { class: "col-md-1" }, _fnSignal(_hf1, [row, idx], _hf1_str), 1, null),
		/*#__PURE__*/ _jsxSorted("td", null, { class: "col-md-4" }, /*#__PURE__*/ _jsxSorted("a", { on:click: qrl(i_App_component_div_map_tr_td_a_onClick_f2rG3o4XBOE, "App_component_div_map_tr_td_a_onClick_f2rG3o4XBOE", [clickedIndex, selectedItem]) }, null, _wrapProp(row.value.label), 1, null), 3, null),
		/*#__PURE__*/ _jsxSorted("td", null, { class: "col-md-1" }, /*#__PURE__*/ _jsxSorted("a", { on:click: qrl(i_App_component_div_map_tr_td_a_onClick_1_TPSouZvQJzc, "App_component_div_map_tr_td_a_onClick_1_TPSouZvQJzc", [data]) }, null, /*#__PURE__*/ _jsxSorted("span", null, { aria-hidden: "true" }, "x", 3, null), 3, null), 3, null),
		/*#__PURE__*/ _jsxSorted("td", null, { class: "col-md-6" }, null, 3, null)
	], 3, untrack(() => row.value.id))), 1, null);
};


None
/*
{
  "origin": "should_extract_single_qrl_with_index.tsx",
  "name": "App_component_BG7ATvMKir4",
  "entry": null,
  "displayName": "should_extract_single_qrl_with_index.tsx_App_component",
  "hash": "BG7ATvMKir4",
  "canonicalFilename": "should_extract_single_qrl_with_index.tsx_App_component_BG7ATvMKir4",
  "path": ".",
  "extension": "js",
  "parent": null,
  "ctxKind": "function",
  "ctxName": "App_component_BG7ATvMKir4",
  "captures": false,
  "loc": [
    0,
    0
  ]
}
*/
============================= ./should_extract_single_qrl_with_index.tsx_App_component_div_map_tr_td_a_onClick_f2rG3o4XBOE.js (ENTRY POINT)==

import { useLexicalScope } from "@qwik.dev/core";
export const App_component_div_map_tr_td_a_onClick_f2rG3o4XBOE = (_, _1, idx, row) => {
	const [clickedIndex, selectedItem] = useLexicalScope();
	if (selectedItem.value) {
		selectedItem.value.selected.value = false;
	}
	selectedItem.value = row.value;
	row.value.selected.value = true;
	clickedIndex.value = idx;
};


None
/*
{
  "origin": "should_extract_single_qrl_with_index.tsx",
  "name": "App_component_div_map_tr_td_a_onClick_f2rG3o4XBOE",
  "entry": null,
  "displayName": "should_extract_single_qrl_with_index.tsx_App_component_div_map_tr_td_a_onClick",
  "hash": "f2rG3o4XBOE",
  "canonicalFilename": "should_extract_single_qrl_with_index.tsx_App_component_div_map_tr_td_a_onClick_f2rG3o4XBOE",
  "path": ".",
  "extension": "js",
  "parent": null,
  "ctxKind": "function",
  "ctxName": "App_component_div_map_tr_td_a_onClick_f2rG3o4XBOE",
  "captures": false,
  "loc": [
    0,
    0
  ]
}
*/
============================= should_extract_single_qrl_with_index.tsx ==

import { componentQrl, qrl } from "@qwik.dev/core";
const i_App_component_div_map_tr_td_a_onClick_f2rG3o4XBOE = () => import("./should_extract_single_qrl_with_index.tsx_App_component_div_map_tr_td_a_onClick_f2rG3o4XBOE.js");
const i_App_component_div_map_tr_td_a_onClick_1_TPSouZvQJzc = () => import("./should_extract_single_qrl_with_index.tsx_App_component_div_map_tr_td_a_onClick_1_TPSouZvQJzc.js");
const i_App_component_BG7ATvMKir4 = () => import("./should_extract_single_qrl_with_index.tsx_App_component_BG7ATvMKir4.js");
const _hf0 = (p0, p1) => p0.value.selected.value ? "danger" : "";
const _hf0_str = "p0.value.selected.value?`danger`:``";
const _hf1 = (p0, p1) => p0.value.id;
const _hf1_str = "p0.value.id";
export const App = componentQrl(qrl(i_App_component_BG7ATvMKir4, "App_component_BG7ATvMKir4"));


None
== DIAGNOSTICS ==

[]
